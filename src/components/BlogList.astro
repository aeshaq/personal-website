---
import { getCollection } from "astro:content";
import { withBase } from "../utils/urls";

const posts = await getCollection("blog");
const sortedPosts = posts
  .slice()
  .sort((a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf());
---

<section class="posts">
  {sortedPosts.map((post) => (
    <article class="post-card">
      <span class="date">
        {post.data.pubDate.toLocaleDateString("en-US", {
          year: "numeric",
          month: "short",
          day: "numeric",
        })}
      </span>
      <h2>
        <a href={withBase(`/blog/${post.slug}`)}>{post.data.title}</a>
      </h2>
      <p>{post.data.description}</p>
    </article>
  ))}
</section>
